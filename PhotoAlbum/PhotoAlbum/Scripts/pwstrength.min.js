/*
* jQuery Password Strength plugin for Twitter Bootstrap
*
* Copyright (c) 2008-2013 Tane Piper
* Copyright (c) 2013 Alejandro Blanco
* Dual licensed under the MIT and GPL licenses.
*/
(function(c){var f={};try{if(!c&&module&&module.exports){var c=require("jquery"),d=require("jsdom").jsdom;c=c(d().parentWindow)}}catch(b){}(function(h,i){var j={};i.forbiddenSequences=["0123456789","abcdefghijklmnopqrstuvwxyz","qwertyuiop","asdfghjkl","zxcvbnm","!@#$%^&*()_+"];j.wordNotEmail=function(k,m,l){if(m.match(/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i)){return l}return 0};j.wordLength=function(l,n,m){var o=n.length,k=Math.pow(o,l.rules.raisePower);if(o<l.common.minChar){k=(k+m)}return k};j.wordSimilarToUsername=function(k,n,l){var m=h(k.common.usernameField).val();if(m&&n.toLowerCase().match(m.replace(/[\-\[\]\/\{\}\(\)\*\+\=\?\:\.\\\^\$\|\!\,]/g,"\\$&").toLowerCase())){return l}return 0};j.wordTwoCharacterClasses=function(k,m,l){if(m.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)||(m.match(/([a-zA-Z])/)&&m.match(/([0-9])/))||(m.match(/(.[!,@,#,$,%,\^,&,*,?,_,~])/)&&m.match(/[a-zA-Z0-9_]/))){return l}return 0};j.wordRepetitions=function(k,m,l){if(m.match(/(.)\1\1/)){return l}return 0};j.wordSequences=function(m,o,n){var k=false,l;if(o.length>2){h.each(i.forbiddenSequences,function(p,q){if(k){return}var r=[q,q.split("").reverse().join("")];h.each(r,function(s,t){for(l=0;l<(o.length-2);l+=1){if(t.indexOf(o.toLowerCase().substring(l,l+3))>-1){k=true}}})});if(k){return n}}return 0};j.wordLowercase=function(k,m,l){return m.match(/[a-z]/)&&l};j.wordUppercase=function(k,m,l){return m.match(/[A-Z]/)&&l};j.wordOneNumber=function(k,m,l){return m.match(/\d+/)&&l};j.wordThreeNumbers=function(k,m,l){return m.match(/(.*[0-9].*[0-9].*[0-9])/)&&l};j.wordOneSpecialChar=function(k,m,l){return m.match(/[!,@,#,$,%,\^,&,*,?,_,~]/)&&l};j.wordTwoSpecialChar=function(k,m,l){return m.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&l};j.wordUpperLowerCombo=function(k,m,l){return m.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&l};j.wordLetterNumberCombo=function(k,m,l){return m.match(/([a-zA-Z])/)&&m.match(/([0-9])/)&&l};j.wordLetterNumberCharCombo=function(k,m,l){return m.match(/([a-zA-Z0-9].*[!,@,#,$,%,\^,&,*,?,_,~])|([!,@,#,$,%,\^,&,*,?,_,~].*[a-zA-Z0-9])/)&&l};i.validation=j;i.executeRules=function(k,m){var l=0;h.each(k.rules.activated,function(r,n){if(n){var s=k.rules.scores[r],p=i.validation[r],q,o;if(!h.isFunction(p)){p=k.rules.extra[r]}if(h.isFunction(p)){q=p(k,m,s);if(q){l+=q}if(q<0||(!h.isNumeric(q)&&!q)){o=k.ui.spanError(k,r);if(o.length>0){k.instances.errors.push(o)}}}}});return l}}(c,f));try{if(module&&module.exports){module.exports=f}}catch(b){}var a={};a.common={};a.common.minChar=6;a.common.usernameField="#UserName";a.common.userInputs=[];a.common.onLoad=undefined;a.common.onKeyUp=undefined;a.common.zxcvbn=false;a.common.zxcvbnTerms=[];a.common.debug=false;a.rules={};a.rules.extra={};a.rules.scores={wordNotEmail:-100,wordLength:-50,wordSimilarToUsername:-100,wordSequences:-20,wordTwoCharacterClasses:2,wordRepetitions:-25,wordLowercase:1,wordUppercase:3,wordOneNumber:3,wordThreeNumbers:5,wordOneSpecialChar:3,wordTwoSpecialChar:5,wordUpperLowerCombo:2,wordLetterNumberCombo:2,wordLetterNumberCharCombo:2};a.rules.activated={wordNotEmail:true,wordLength:true,wordSimilarToUsername:true,wordSequences:true,wordTwoCharacterClasses:false,wordRepetitions:false,wordLowercase:true,wordUppercase:true,wordOneNumber:true,wordThreeNumbers:true,wordOneSpecialChar:true,wordTwoSpecialChar:true,wordUpperLowerCombo:true,wordLetterNumberCombo:true,wordLetterNumberCharCombo:true};a.rules.raisePower=1.4;a.ui={};a.ui.bootstrap2=false;a.ui.bootstrap4=false;a.ui.colorClasses=["danger","warning","success"];a.ui.showProgressBar=true;a.ui.showPopover=false;a.ui.popoverPlacement="bottom";a.ui.showStatus=false;a.ui.spanError=function(i,h){var j=i.ui.errorMessages[h];if(!j){return""}return'<span style="color: #d52929">'+j+"</span>"};a.ui.popoverError=function(h){var i="<div>Errors:<ul class='error-list' style='margin-bottom: 0;'>";c.each(h,function(k,j){i+="<li>"+j+"</li>"});i+="</ul></div>";return i};a.ui.errorMessages={wordLength:"Your password is too short",wordNotEmail:"Do not use your email as your password",wordSimilarToUsername:"Your password cannot contain your username",wordTwoCharacterClasses:"Use different character classes",wordRepetitions:"Too many repetitions",wordSequences:"Your password contains sequences"};a.ui.verdicts=["Weak","Normal","Medium","Strong","Very Strong"];a.ui.showVerdicts=true;a.ui.showVerdictsInsideProgressBar=false;a.ui.useVerdictCssClass=false;a.ui.showErrors=false;a.ui.container=undefined;a.ui.viewports={progress:undefined,verdict:undefined,errors:undefined};a.ui.scores=[14,26,38,50];var g={};(function(h,j){var i=["error","warning","success"];j.getContainer=function(m,l){var k;k=h(m.ui.container);if(!(k&&k.length===1)){k=l.parent()}return k};j.findElement=function(k,m,l){if(m){return k.find(m).find(l)}return k.find(l)};j.getUIElements=function(m,l){var k,o,n;if(m.instances.viewports){return m.instances.viewports}k=j.getContainer(m,l);n={};if(m.ui.bootstrap4){o="progress.progress"}else{o="div.progress"}n.$progressbar=j.findElement(k,m.ui.viewports.progress,o);if(m.ui.showVerdictsInsideProgressBar){n.$verdict=n.$progressbar.find("span.password-verdict")}if(!m.ui.showPopover){if(!m.ui.showVerdictsInsideProgressBar){n.$verdict=j.findElement(k,m.ui.viewports.verdict,"span.password-verdict")}n.$errors=j.findElement(k,m.ui.viewports.errors,"ul.error-list")}m.instances.viewports=n;return n};j.initProgressBar=function(m,l){var k=j.getContainer(m,l),n="<div class='progress'><div class='";if(!m.ui.bootstrap2&&!m.ui.bootstrap4){n+="progress-"}n+="bar'>";if(m.ui.bootstrap4){n="<progress class='progress' value='0' max='100'>"}if(m.ui.showVerdictsInsideProgressBar){n+="<span class='password-verdict'></span>"}if(m.ui.bootstrap4){n+="</progress>"}else{n+="</div></div>"}if(m.ui.viewports.progress){k.find(m.ui.viewports.progress).append(n)}else{h(n).insertAfter(l)}};j.initHelper=function(n,l,m,o){var k=j.getContainer(n,l);if(o){k.find(o).append(m)}else{h(m).insertAfter(l)}};j.initVerdict=function(l,k){j.initHelper(l,k,"<span class='password-verdict'></span>",l.ui.viewports.verdict)};j.initErrorList=function(l,k){j.initHelper(l,k,"<ul class='error-list'></ul>",l.ui.viewports.errors)};j.initPopover=function(l,k){k.popover("destroy");k.popover({html:true,placement:l.ui.popoverPlacement,trigger:"manual",content:" "})};j.initUI=function(l,k){if(l.ui.showPopover){j.initPopover(l,k)}else{if(l.ui.showErrors){j.initErrorList(l,k)}if(l.ui.showVerdicts&&!l.ui.showVerdictsInsideProgressBar){j.initVerdict(l,k)}}if(l.ui.showProgressBar){j.initProgressBar(l,k)}};j.updateProgressBar=function(p,l,n,q){var m=j.getUIElements(p,l).$progressbar,k=m.find(".progress-bar"),o="progress-";if(p.ui.bootstrap2){k=m.find(".bar");o=""}h.each(p.ui.colorClasses,function(r,s){if(p.ui.bootstrap4){m.removeClass(o+s)}else{k.removeClass(o+"bar-"+s)}});if(p.ui.bootstrap4){m.addClass(o+p.ui.colorClasses[n]);m.val(q)}else{k.addClass(o+"bar-"+p.ui.colorClasses[n]);k.css("width",q+"%")}};j.updateVerdict=function(n,k,m,o){var l=j.getUIElements(n,k).$verdict;l.removeClass(n.ui.colorClasses.join(" "));if(m>-1){l.addClass(n.ui.colorClasses[m])}l.html(o)};j.updateErrors=function(n,k){var l=j.getUIElements(n,k).$errors,m="";h.each(n.instances.errors,function(p,o){m+="<li>"+o+"</li>"});l.html(m)};j.updatePopover=function(n,k,p){var o=k.data("bs.popover"),m="",l=true;if(n.ui.showVerdicts&&!n.ui.showVerdictsInsideProgressBar&&p.length>0){m="<h5><span class='password-verdict'>"+p+"</span></h5>";l=false}if(n.ui.showErrors){if(n.instances.errors.length>0){l=false}m+=n.ui.popoverError(n.instances.errors)}if(l){k.popover("hide");return}if(n.ui.bootstrap2){o=k.data("popover")}if(o.$arrow&&o.$arrow.parents("body").length>0){k.find("+ .popover .popover-content").html(m)}else{o.options.content=m;k.popover("show")}};j.updateFieldStatus=function(n,l,m){var o=n.ui.bootstrap2?".control-group":".form-group",k=l.parents(o).first();h.each(i,function(q,p){if(!n.ui.bootstrap2){p="has-"+p}k.removeClass(p)});m=i[m];if(!n.ui.bootstrap2){m="has-"+m}k.addClass(m)};j.percentage=function(m,k){var l=Math.floor(100*m/k);l=l<=0?1:l;l=l>100?100:l;return l};j.getVerdictAndCssClass=function(m,n){var k,o,l;if(n<=0){k=0;l=-1;o=m.ui.verdicts[0]}else{if(n<m.ui.scores[0]){k=0;l=0;o=m.ui.verdicts[0]}else{if(n<m.ui.scores[1]){k=0;l=1;o=m.ui.verdicts[1]}else{if(n<m.ui.scores[2]){k=1;l=2;o=m.ui.verdicts[2]}else{if(n<m.ui.scores[3]){k=1;l=3;o=m.ui.verdicts[3]}else{k=2;l=4;o=m.ui.verdicts[4]}}}}}return[o,k,l]};j.updateUI=function(n,k,o){var m,l,q,p;m=j.getVerdictAndCssClass(n,o);q=o===0?"":m[0];m=m[1];p=n.ui.useVerdictCssClass?m:-1;if(n.ui.showProgressBar){l=j.percentage(o,n.ui.scores[3]);j.updateProgressBar(n,k,m,l);if(n.ui.showVerdictsInsideProgressBar){j.updateVerdict(n,k,p,q)}}if(n.ui.showStatus){j.updateFieldStatus(n,k,m)}if(n.ui.showPopover){j.updatePopover(n,k,q)}else{if(n.ui.showVerdicts&&!n.ui.showVerdictsInsideProgressBar){j.updateVerdict(n,k,p,q)}if(n.ui.showErrors){j.updateErrors(n,k)}}}}(c,g));var e={};(function(h,j){var k,i;k=function(m){var l=h(m.target),n=l.data("pwstrength-bootstrap"),s=l.val(),p,r,q,o;if(n===undefined){return}n.instances.errors=[];if(s.length===0){o=0}else{if(n.common.zxcvbn){p=[];h.each(n.common.userInputs.concat([n.common.usernameField]),function(t,u){var v=h(u).val();if(v){p.push(v)}});p=p.concat(n.common.zxcvbnTerms);o=Math.log2(zxcvbn(s,p).guesses)}else{o=f.executeRules(n,s)}}g.updateUI(n,l,o);r=g.getVerdictAndCssClass(n,o);q=r[2];r=r[0];if(n.common.debug){console.log(o+" - "+r)}if(h.isFunction(n.common.onKeyUp)){n.common.onKeyUp(m,{score:o,verdictText:r,verdictLevel:q})}};j.init=function(l){this.each(function(p,o){var n=h.extend(true,{},a),q=h.extend(true,n,l),m=h(o);q.instances={};m.data("pwstrength-bootstrap",q);m.on("keyup",k);m.on("change",k);m.on("paste",k);g.initUI(q,m);if(h.trim(m.val())){m.trigger("keyup")}if(h.isFunction(q.common.onLoad)){q.common.onLoad()}});return this};j.destroy=function(){this.each(function(o,m){var l=h(m),p=l.data("pwstrength-bootstrap"),n=g.getUIElements(p,l);n.$progressbar.remove();n.$verdict.remove();n.$errors.remove();l.removeData("pwstrength-bootstrap")})};j.forceUpdate=function(){this.each(function(n,l){var m={target:l};k(m)})};j.addRule=function(n,m,o,l){this.each(function(q,p){var r=h(p).data("pwstrength-bootstrap");r.rules.activated[n]=l;r.rules.scores[n]=o;r.rules.extra[n]=m})};i=function(m,l,n){this.each(function(p,o){h(o).data("pwstrength-bootstrap").rules[l][m]=n})};j.changeScore=function(l,m){i.call(this,l,"scores",m)};j.ruleActive=function(m,l){i.call(this,m,"activated",l)};h.fn.pwstrength=function(l){var m;if(j[l]){m=j[l].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof l==="object"||!l){m=j.init.apply(this,arguments)}else{h.error("Method "+l+" does not exist on jQuery.pwstrength-bootstrap")}}return m}}(c,e))}(jQuery));